!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).Xumm=e()}}((function(){return function e(t,n,o){function r(s,a){if(!n[s]){if(!t[s]){var u="function"==typeof require&&require;if(!a&&u)return u(s,!0);if(i)return i(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var l=n[s]={exports:{}};t[s][0].call(l.exports,(function(e){return r(t[s][1][e]||e)}),l,l.exports,e,t,n,o)}return n[s].exports}for(var i="function"==typeof require&&require,s=0;s<o.length;s++)r(o[s]);return r}({1:[function(e,t,n){},{}],2:[function(e,t,n){var o=Object.create||function(e){var t=function(){};return t.prototype=e,new t},r=Object.keys||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return n},i=Function.prototype.bind||function(e){var t=this;return function(){return t.apply(e,arguments)}};function s(){this._events&&Object.prototype.hasOwnProperty.call(this,"_events")||(this._events=o(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0}t.exports=s,s.EventEmitter=s,s.prototype._events=void 0,s.prototype._maxListeners=void 0;var a,u=10;try{var c={};Object.defineProperty&&Object.defineProperty(c,"x",{value:0}),a=0===c.x}catch(e){a=!1}function l(e){return void 0===e._maxListeners?s.defaultMaxListeners:e._maxListeners}function d(e,t,n){if(t)e.call(n);else for(var o=e.length,r=_(e,o),i=0;i<o;++i)r[i].call(n)}function h(e,t,n,o){if(t)e.call(n,o);else for(var r=e.length,i=_(e,r),s=0;s<r;++s)i[s].call(n,o)}function f(e,t,n,o,r){if(t)e.call(n,o,r);else for(var i=e.length,s=_(e,i),a=0;a<i;++a)s[a].call(n,o,r)}function p(e,t,n,o,r,i){if(t)e.call(n,o,r,i);else for(var s=e.length,a=_(e,s),u=0;u<s;++u)a[u].call(n,o,r,i)}function v(e,t,n,o){if(t)e.apply(n,o);else for(var r=e.length,i=_(e,r),s=0;s<r;++s)i[s].apply(n,o)}function m(e,t,n,r){var i,s,a;if("function"!=typeof n)throw new TypeError('"listener" argument must be a function');if((s=e._events)?(s.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),s=e._events),a=s[t]):(s=e._events=o(null),e._eventsCount=0),a){if("function"==typeof a?a=s[t]=r?[n,a]:[a,n]:r?a.unshift(n):a.push(n),!a.warned&&(i=l(e))&&i>0&&a.length>i){a.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+a.length+' "'+String(t)+'" listeners added. Use emitter.setMaxListeners() to increase limit.');u.name="MaxListenersExceededWarning",u.emitter=e,u.type=t,u.count=a.length,"object"==typeof console&&console.warn&&console.warn("%s: %s",u.name,u.message)}}else a=s[t]=n,++e._eventsCount;return e}function y(){if(!this.fired)switch(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length){case 0:return this.listener.call(this.target);case 1:return this.listener.call(this.target,arguments[0]);case 2:return this.listener.call(this.target,arguments[0],arguments[1]);case 3:return this.listener.call(this.target,arguments[0],arguments[1],arguments[2]);default:for(var e=new Array(arguments.length),t=0;t<e.length;++t)e[t]=arguments[t];this.listener.apply(this.target,e)}}function w(e,t,n){var o={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},r=i.call(y,o);return r.listener=n,o.wrapFn=r,r}function g(e,t,n){var o=e._events;if(!o)return[];var r=o[t];return r?"function"==typeof r?n?[r.listener||r]:[r]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(r):_(r,r.length):[]}function b(e){var t=this._events;if(t){var n=t[e];if("function"==typeof n)return 1;if(n)return n.length}return 0}function _(e,t){for(var n=new Array(t),o=0;o<t;++o)n[o]=e[o];return n}a?Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return u},set:function(e){if("number"!=typeof e||e<0||e!=e)throw new TypeError('"defaultMaxListeners" must be a positive number');u=e}}):s.defaultMaxListeners=u,s.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=e,this},s.prototype.getMaxListeners=function(){return l(this)},s.prototype.emit=function(e){var t,n,o,r,i,s,a="error"===e;if(s=this._events)a=a&&null==s.error;else if(!a)return!1;if(a){if(arguments.length>1&&(t=arguments[1]),t instanceof Error)throw t;var u=new Error('Unhandled "error" event. ('+t+")");throw u.context=t,u}if(!(n=s[e]))return!1;var c="function"==typeof n;switch(o=arguments.length){case 1:d(n,c,this);break;case 2:h(n,c,this,arguments[1]);break;case 3:f(n,c,this,arguments[1],arguments[2]);break;case 4:p(n,c,this,arguments[1],arguments[2],arguments[3]);break;default:for(r=new Array(o-1),i=1;i<o;i++)r[i-1]=arguments[i];v(n,c,this,r)}return!0},s.prototype.addListener=function(e,t){return m(this,e,t,!1)},s.prototype.on=s.prototype.addListener,s.prototype.prependListener=function(e,t){return m(this,e,t,!0)},s.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.on(e,w(this,e,t)),this},s.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.prependListener(e,w(this,e,t)),this},s.prototype.removeListener=function(e,t){var n,r,i,s,a;if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');if(!(r=this._events))return this;if(!(n=r[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=o(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(i=-1,s=n.length-1;s>=0;s--)if(n[s]===t||n[s].listener===t){a=n[s].listener,i=s;break}if(i<0)return this;0===i?n.shift():function(e,t){for(var n=t,o=n+1,r=e.length;o<r;n+=1,o+=1)e[n]=e[o];e.pop()}(n,i),1===n.length&&(r[e]=n[0]),r.removeListener&&this.emit("removeListener",e,a||t)}return this},s.prototype.removeAllListeners=function(e){var t,n,i;if(!(n=this._events))return this;if(!n.removeListener)return 0===arguments.length?(this._events=o(null),this._eventsCount=0):n[e]&&(0==--this._eventsCount?this._events=o(null):delete n[e]),this;if(0===arguments.length){var s,a=r(n);for(i=0;i<a.length;++i)"removeListener"!==(s=a[i])&&this.removeAllListeners(s);return this.removeAllListeners("removeListener"),this._events=o(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(t)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this},s.prototype.listeners=function(e){return g(this,e,!0)},s.prototype.rawListeners=function(e){return g(this,e,!1)},s.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):b.call(e,t)},s.prototype.listenerCount=b,s.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]}},{}],3:[function(e,t,n){(function(o){(function(){var r,i;r=this,i=function(){var t=t||function(t,n){var r;if("undefined"!=typeof window&&window.crypto&&(r=window.crypto),"undefined"!=typeof self&&self.crypto&&(r=self.crypto),"undefined"!=typeof globalThis&&globalThis.crypto&&(r=globalThis.crypto),!r&&"undefined"!=typeof window&&window.msCrypto&&(r=window.msCrypto),!r&&void 0!==o&&o.crypto&&(r=o.crypto),!r&&"function"==typeof e)try{r=e("crypto")}catch(e){}var i=function(){if(r){if("function"==typeof r.getRandomValues)try{return r.getRandomValues(new Uint32Array(1))[0]}catch(e){}if("function"==typeof r.randomBytes)try{return r.randomBytes(4).readInt32LE()}catch(e){}}throw new Error("Native crypto module could not be used to get secure random number.")},s=Object.create||function(){function e(){}return function(t){var n;return e.prototype=t,n=new e,e.prototype=null,n}}(),a={},u=a.lib={},c=u.Base={extend:function(e){var t=s(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},l=u.WordArray=c.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||h).stringify(this)},concat:function(e){var t=this.words,n=e.words,o=this.sigBytes,r=e.sigBytes;if(this.clamp(),o%4)for(var i=0;i<r;i++){var s=n[i>>>2]>>>24-i%4*8&255;t[o+i>>>2]|=s<<24-(o+i)%4*8}else for(var a=0;a<r;a+=4)t[o+a>>>2]=n[a>>>2];return this.sigBytes+=r,this},clamp:function(){var e=this.words,n=this.sigBytes;e[n>>>2]&=4294967295<<32-n%4*8,e.length=t.ceil(n/4)},clone:function(){var e=c.clone.call(this);return e.words=this.words.slice(0),e},random:function(e){for(var t=[],n=0;n<e;n+=4)t.push(i());return new l.init(t,e)}}),d=a.enc={},h=d.Hex={stringify:function(e){for(var t=e.words,n=e.sigBytes,o=[],r=0;r<n;r++){var i=t[r>>>2]>>>24-r%4*8&255;o.push((i>>>4).toString(16)),o.push((15&i).toString(16))}return o.join("")},parse:function(e){for(var t=e.length,n=[],o=0;o<t;o+=2)n[o>>>3]|=parseInt(e.substr(o,2),16)<<24-o%8*4;return new l.init(n,t/2)}},f=d.Latin1={stringify:function(e){for(var t=e.words,n=e.sigBytes,o=[],r=0;r<n;r++){var i=t[r>>>2]>>>24-r%4*8&255;o.push(String.fromCharCode(i))}return o.join("")},parse:function(e){for(var t=e.length,n=[],o=0;o<t;o++)n[o>>>2]|=(255&e.charCodeAt(o))<<24-o%4*8;return new l.init(n,t)}},p=d.Utf8={stringify:function(e){try{return decodeURIComponent(escape(f.stringify(e)))}catch(e){throw new Error("Malformed UTF-8 data")}},parse:function(e){return f.parse(unescape(encodeURIComponent(e)))}},v=u.BufferedBlockAlgorithm=c.extend({reset:function(){this._data=new l.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=p.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(e){var n,o=this._data,r=o.words,i=o.sigBytes,s=this.blockSize,a=i/(4*s),u=(a=e?t.ceil(a):t.max((0|a)-this._minBufferSize,0))*s,c=t.min(4*u,i);if(u){for(var d=0;d<u;d+=s)this._doProcessBlock(r,d);n=r.splice(0,u),o.sigBytes-=c}return new l.init(n,c)},clone:function(){var e=c.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),m=(u.Hasher=v.extend({cfg:c.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){v.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new m.HMAC.init(e,n).finalize(t)}}}),a.algo={});return a}(Math);return t},"object"==typeof n?t.exports=n=i():r.CryptoJS=i()}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{crypto:1}],4:[function(e,t,n){var o,r;o=this,r=function(e){var t,n;return n=(t=e).lib.WordArray,t.enc.Base64={stringify:function(e){var t=e.words,n=e.sigBytes,o=this._map;e.clamp();for(var r=[],i=0;i<n;i+=3)for(var s=(t[i>>>2]>>>24-i%4*8&255)<<16|(t[i+1>>>2]>>>24-(i+1)%4*8&255)<<8|t[i+2>>>2]>>>24-(i+2)%4*8&255,a=0;a<4&&i+.75*a<n;a++)r.push(o.charAt(s>>>6*(3-a)&63));var u=o.charAt(64);if(u)for(;r.length%4;)r.push(u);return r.join("")},parse:function(e){var t=e.length,o=this._map,r=this._reverseMap;if(!r){r=this._reverseMap=[];for(var i=0;i<o.length;i++)r[o.charCodeAt(i)]=i}var s=o.charAt(64);if(s){var a=e.indexOf(s);-1!==a&&(t=a)}return function(e,t,o){for(var r=[],i=0,s=0;s<t;s++)if(s%4){var a=o[e.charCodeAt(s-1)]<<s%4*2|o[e.charCodeAt(s)]>>>6-s%4*2;r[i>>>2]|=a<<24-i%4*8,i++}return n.create(r,i)}(e,t,r)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},e.enc.Base64},"object"==typeof n?t.exports=n=r(e("./core")):r(o.CryptoJS)},{"./core":3}],5:[function(e,t,n){var o,r;o=this,r=function(e){return function(){if("function"==typeof ArrayBuffer){var t=e.lib.WordArray,n=t.init,o=t.init=function(e){if(e instanceof ArrayBuffer&&(e=new Uint8Array(e)),(e instanceof Int8Array||"undefined"!=typeof Uint8ClampedArray&&e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array)&&(e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength)),e instanceof Uint8Array){for(var t=e.byteLength,o=[],r=0;r<t;r++)o[r>>>2]|=e[r]<<24-r%4*8;n.call(this,o,t)}else n.apply(this,arguments)};o.prototype=t}}(),e.lib.WordArray},"object"==typeof n?t.exports=n=r(e("./core")):r(o.CryptoJS)},{"./core":3}],6:[function(e,t,n){var o,r;o=this,r=function(e){return function(t){var n=e,o=n.lib,r=o.WordArray,i=o.Hasher,s=n.algo,a=[],u=[];!function(){function e(e){for(var n=t.sqrt(e),o=2;o<=n;o++)if(!(e%o))return!1;return!0}function n(e){return 4294967296*(e-(0|e))|0}for(var o=2,r=0;r<64;)e(o)&&(r<8&&(a[r]=n(t.pow(o,.5))),u[r]=n(t.pow(o,1/3)),r++),o++}();var c=[],l=s.SHA256=i.extend({_doReset:function(){this._hash=new r.init(a.slice(0))},_doProcessBlock:function(e,t){for(var n=this._hash.words,o=n[0],r=n[1],i=n[2],s=n[3],a=n[4],l=n[5],d=n[6],h=n[7],f=0;f<64;f++){if(f<16)c[f]=0|e[t+f];else{var p=c[f-15],v=(p<<25|p>>>7)^(p<<14|p>>>18)^p>>>3,m=c[f-2],y=(m<<15|m>>>17)^(m<<13|m>>>19)^m>>>10;c[f]=v+c[f-7]+y+c[f-16]}var w=o&r^o&i^r&i,g=(o<<30|o>>>2)^(o<<19|o>>>13)^(o<<10|o>>>22),b=h+((a<<26|a>>>6)^(a<<21|a>>>11)^(a<<7|a>>>25))+(a&l^~a&d)+u[f]+c[f];h=d,d=l,l=a,a=s+b|0,s=i,i=r,r=o,o=b+(g+w)|0}n[0]=n[0]+o|0,n[1]=n[1]+r|0,n[2]=n[2]+i|0,n[3]=n[3]+s|0,n[4]=n[4]+a|0,n[5]=n[5]+l|0,n[6]=n[6]+d|0,n[7]=n[7]+h|0},_doFinalize:function(){var e=this._data,n=e.words,o=8*this._nDataBytes,r=8*e.sigBytes;return n[r>>>5]|=128<<24-r%32,n[14+(r+64>>>9<<4)]=t.floor(o/4294967296),n[15+(r+64>>>9<<4)]=o,e.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var e=i.clone.call(this);return e._hash=this._hash.clone(),e}});n.SHA256=i._createHelper(l),n.HmacSHA256=i._createHmacHelper(l)}(Math),e.SHA256},"object"==typeof n?t.exports=n=r(e("./core")):r(o.CryptoJS)},{"./core":3}],7:[function(e,t,n){(function(o){(function(){n.formatArgs=function(e){if(e[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),!this.useColors)return;const n="color: "+this.color;e.splice(1,0,n,"color: inherit");let o=0,r=0;e[0].replace(/%[a-zA-Z%]/g,(e=>{"%%"!==e&&(o++,"%c"===e&&(r=o))})),e.splice(r,0,n)},n.save=function(e){try{e?n.storage.setItem("debug",e):n.storage.removeItem("debug")}catch(e){}},n.load=function(){let e;try{e=n.storage.getItem("debug")}catch(e){}!e&&void 0!==o&&"env"in o&&(e=o.env.DEBUG);return e},n.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},n.storage=function(){try{return localStorage}catch(e){}}(),n.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),n.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],n.log=console.debug||console.log||(()=>{}),t.exports=e("./common")(n);const{formatters:r}=t.exports;r.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}}).call(this)}).call(this,e("_process"))},{"./common":8,_process:13}],8:[function(e,t,n){t.exports=function(t){function n(e){let t,r,i,s=null;function a(...e){if(!a.enabled)return;const o=a,r=Number(new Date),i=r-(t||r);o.diff=i,o.prev=t,o.curr=r,t=r,e[0]=n.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let s=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,((t,r)=>{if("%%"===t)return"%";s++;const i=n.formatters[r];if("function"==typeof i){const n=e[s];t=i.call(o,n),e.splice(s,1),s--}return t})),n.formatArgs.call(o,e);(o.log||n.log).apply(o,e)}return a.namespace=e,a.useColors=n.useColors(),a.color=n.selectColor(e),a.extend=o,a.destroy=n.destroy,Object.defineProperty(a,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==s?s:(r!==n.namespaces&&(r=n.namespaces,i=n.enabled(e)),i),set:e=>{s=e}}),"function"==typeof n.init&&n.init(a),a}function o(e,t){const o=n(this.namespace+(void 0===t?":":t)+e);return o.log=this.log,o}function r(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return n.debug=n,n.default=n,n.coerce=function(e){if(e instanceof Error)return e.stack||e.message;return e},n.disable=function(){const e=[...n.names.map(r),...n.skips.map(r).map((e=>"-"+e))].join(",");return n.enable(""),e},n.enable=function(e){let t;n.save(e),n.namespaces=e,n.names=[],n.skips=[];const o=("string"==typeof e?e:"").split(/[\s,]+/),r=o.length;for(t=0;t<r;t++)o[t]&&("-"===(e=o[t].replace(/\*/g,".*?"))[0]?n.skips.push(new RegExp("^"+e.slice(1)+"$")):n.names.push(new RegExp("^"+e+"$")))},n.enabled=function(e){if("*"===e[e.length-1])return!0;let t,o;for(t=0,o=n.skips.length;t<o;t++)if(n.skips[t].test(e))return!1;for(t=0,o=n.names.length;t<o;t++)if(n.names[t].test(e))return!0;return!1},n.humanize=e("ms"),n.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(t).forEach((e=>{n[e]=t[e]})),n.names=[],n.skips=[],n.formatters={},n.selectColor=function(e){let t=0;for(let n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t|=0;return n.colors[Math.abs(t)%n.colors.length]},n.enable(n.load()),n}},{ms:11}],9:[function(e,t,n){var o=function(){if("object"==typeof self&&self)return self;if("object"==typeof window&&window)return window;throw new Error("Unable to resolve global `this`")};t.exports=function(){if(this)return this;if("object"==typeof globalThis&&globalThis)return globalThis;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch(e){return o()}try{return __global__||o()}finally{delete Object.prototype.__global__}}()},{}],10:[function(e,t,n){(function(e){(function(){!function(e){"use strict";function o(o){var r=o&&o.Promise||e.Promise,i=o&&o.XMLHttpRequest||e.XMLHttpRequest;return function(){var o=Object.create(e,{fetch:{value:void 0,writable:!0}});return function(e,o){o("object"==typeof n&&void 0!==t?n:e.WHATWGFetch={})}(this,(function(e){var t=void 0!==o&&o||"undefined"!=typeof self&&self||void 0!==t&&t,n="URLSearchParams"in t,s="Symbol"in t&&"iterator"in Symbol,a="FileReader"in t&&"Blob"in t&&function(){try{return new Blob,!0}catch(e){return!1}}(),u="FormData"in t,c="ArrayBuffer"in t;if(c)var l=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],d=ArrayBuffer.isView||function(e){return e&&l.indexOf(Object.prototype.toString.call(e))>-1};function h(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(e)||""===e)throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function f(e){return"string"!=typeof e&&(e=String(e)),e}function p(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return s&&(t[Symbol.iterator]=function(){return t}),t}function v(e){this.map={},e instanceof v?e.forEach((function(e,t){this.append(t,e)}),this):Array.isArray(e)?e.forEach((function(e){this.append(e[0],e[1])}),this):e&&Object.getOwnPropertyNames(e).forEach((function(t){this.append(t,e[t])}),this)}function m(e){if(e.bodyUsed)return r.reject(new TypeError("Already read"));e.bodyUsed=!0}function y(e){return new r((function(t,n){e.onload=function(){t(e.result)},e.onerror=function(){n(e.error)}}))}function w(e){var t=new FileReader,n=y(t);return t.readAsArrayBuffer(e),n}function g(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function b(){return this.bodyUsed=!1,this._initBody=function(e){var t;this.bodyUsed=this.bodyUsed,this._bodyInit=e,e?"string"==typeof e?this._bodyText=e:a&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:u&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:n&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():c&&a&&((t=e)&&DataView.prototype.isPrototypeOf(t))?(this._bodyArrayBuffer=g(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):c&&(ArrayBuffer.prototype.isPrototypeOf(e)||d(e))?this._bodyArrayBuffer=g(e):this._bodyText=e=Object.prototype.toString.call(e):this._bodyText="",this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):n&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},a&&(this.blob=function(){var e=m(this);if(e)return e;if(this._bodyBlob)return r.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return r.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return r.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){if(this._bodyArrayBuffer){var e=m(this);return e||(ArrayBuffer.isView(this._bodyArrayBuffer)?r.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):r.resolve(this._bodyArrayBuffer))}return this.blob().then(w)}),this.text=function(){var e,t,n,o=m(this);if(o)return o;if(this._bodyBlob)return e=this._bodyBlob,t=new FileReader,n=y(t),t.readAsText(e),n;if(this._bodyArrayBuffer)return r.resolve(function(e){for(var t=new Uint8Array(e),n=new Array(t.length),o=0;o<t.length;o++)n[o]=String.fromCharCode(t[o]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return r.resolve(this._bodyText)},u&&(this.formData=function(){return this.text().then(k)}),this.json=function(){return this.text().then(JSON.parse)},this}v.prototype.append=function(e,t){e=h(e),t=f(t);var n=this.map[e];this.map[e]=n?n+", "+t:t},v.prototype.delete=function(e){delete this.map[h(e)]},v.prototype.get=function(e){return e=h(e),this.has(e)?this.map[e]:null},v.prototype.has=function(e){return this.map.hasOwnProperty(h(e))},v.prototype.set=function(e,t){this.map[h(e)]=f(t)},v.prototype.forEach=function(e,t){for(var n in this.map)this.map.hasOwnProperty(n)&&e.call(t,this.map[n],n,this)},v.prototype.keys=function(){var e=[];return this.forEach((function(t,n){e.push(n)})),p(e)},v.prototype.values=function(){var e=[];return this.forEach((function(t){e.push(t)})),p(e)},v.prototype.entries=function(){var e=[];return this.forEach((function(t,n){e.push([n,t])})),p(e)},s&&(v.prototype[Symbol.iterator]=v.prototype.entries);var _=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function x(e,t){if(!(this instanceof x))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');var n,o,r=(t=t||{}).body;if(e instanceof x){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new v(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,r||null==e._bodyInit||(r=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"same-origin",!t.headers&&this.headers||(this.headers=new v(t.headers)),this.method=(n=t.method||this.method||"GET",o=n.toUpperCase(),_.indexOf(o)>-1?o:n),this.mode=t.mode||this.mode||null,this.signal=t.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&r)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(r),!("GET"!==this.method&&"HEAD"!==this.method||"no-store"!==t.cache&&"no-cache"!==t.cache)){var i=/([?&])_=[^&]*/;if(i.test(this.url))this.url=this.url.replace(i,"$1_="+(new Date).getTime());else{this.url+=(/\?/.test(this.url)?"&":"?")+"_="+(new Date).getTime()}}}function k(e){var t=new FormData;return e.trim().split("&").forEach((function(e){if(e){var n=e.split("="),o=n.shift().replace(/\+/g," "),r=n.join("=").replace(/\+/g," ");t.append(decodeURIComponent(o),decodeURIComponent(r))}})),t}function S(e,t){if(!(this instanceof S))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"",this.headers=new v(t.headers),this.url=t.url||"",this._initBody(e)}x.prototype.clone=function(){return new x(this,{body:this._bodyInit})},b.call(x.prototype),b.call(S.prototype),S.prototype.clone=function(){return new S(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new v(this.headers),url:this.url})},S.error=function(){var e=new S(null,{status:0,statusText:""});return e.type="error",e};var P=[301,302,303,307,308];S.redirect=function(e,t){if(-1===P.indexOf(t))throw new RangeError("Invalid status code");return new S(null,{status:t,headers:{location:e}})},e.DOMException=t.DOMException;try{new e.DOMException}catch(t){e.DOMException=function(e,t){this.message=e,this.name=t;var n=Error(e);this.stack=n.stack},e.DOMException.prototype=Object.create(Error.prototype),e.DOMException.prototype.constructor=e.DOMException}function A(n,o){return new r((function(r,s){var u=new x(n,o);if(u.signal&&u.signal.aborted)return s(new e.DOMException("Aborted","AbortError"));var l=new i;function d(){l.abort()}l.onload=function(){var e,t,n={status:l.status,statusText:l.statusText,headers:(e=l.getAllResponseHeaders()||"",t=new v,e.replace(/\r?\n[\t ]+/g," ").split("\r").map((function(e){return 0===e.indexOf("\n")?e.substr(1,e.length):e})).forEach((function(e){var n=e.split(":"),o=n.shift().trim();if(o){var r=n.join(":").trim();t.append(o,r)}})),t)};n.url="responseURL"in l?l.responseURL:n.headers.get("X-Request-URL");var o="response"in l?l.response:l.responseText;setTimeout((function(){r(new S(o,n))}),0)},l.onerror=function(){setTimeout((function(){s(new TypeError("Network request failed"))}),0)},l.ontimeout=function(){setTimeout((function(){s(new TypeError("Network request failed"))}),0)},l.onabort=function(){setTimeout((function(){s(new e.DOMException("Aborted","AbortError"))}),0)},l.open(u.method,function(e){try{return""===e&&t.location.href?t.location.href:e}catch(t){return e}}(u.url),!0),"include"===u.credentials?l.withCredentials=!0:"omit"===u.credentials&&(l.withCredentials=!1),"responseType"in l&&(a?l.responseType="blob":c&&u.headers.get("Content-Type")&&-1!==u.headers.get("Content-Type").indexOf("application/octet-stream")&&(l.responseType="arraybuffer")),!o||"object"!=typeof o.headers||o.headers instanceof v?u.headers.forEach((function(e,t){l.setRequestHeader(t,e)})):Object.getOwnPropertyNames(o.headers).forEach((function(e){l.setRequestHeader(e,f(o.headers[e]))})),u.signal&&(u.signal.addEventListener("abort",d),l.onreadystatechange=function(){4===l.readyState&&u.signal.removeEventListener("abort",d)}),l.send(void 0===u._bodyInit?null:u._bodyInit)}))}A.polyfill=!0,t.fetch||(t.fetch=A,t.Headers=v,t.Request=x,t.Response=S),e.Headers=v,e.Request=x,e.Response=S,e.fetch=A,Object.defineProperty(e,"__esModule",{value:!0})})),{fetch:o.fetch,Headers:o.Headers,Request:o.Request,Response:o.Response,DOMException:o.DOMException}}()}"object"==typeof n?t.exports=o:e.fetchPonyfill=o}("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:void 0!==e?e:this)}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],11:[function(e,t,n){var o=1e3,r=60*o,i=60*r,s=24*i,a=7*s,u=365.25*s;function c(e,t,n,o){var r=t>=1.5*n;return Math.round(e/n)+" "+o+(r?"s":"")}t.exports=function(e,t){t=t||{};var n=typeof e;if("string"===n&&e.length>0)return function(e){if((e=String(e)).length>100)return;var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!t)return;var n=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return n*u;case"weeks":case"week":case"w":return n*a;case"days":case"day":case"d":return n*s;case"hours":case"hour":case"hrs":case"hr":case"h":return n*i;case"minutes":case"minute":case"mins":case"min":case"m":return n*r;case"seconds":case"second":case"secs":case"sec":case"s":return n*o;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n;default:return}}(e);if("number"===n&&isFinite(e))return t.long?function(e){var t=Math.abs(e);if(t>=s)return c(e,t,s,"day");if(t>=i)return c(e,t,i,"hour");if(t>=r)return c(e,t,r,"minute");if(t>=o)return c(e,t,o,"second");return e+" ms"}(e):function(e){var t=Math.abs(e);if(t>=s)return Math.round(e/s)+"d";if(t>=i)return Math.round(e/i)+"h";if(t>=r)return Math.round(e/r)+"m";if(t>=o)return Math.round(e/o)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},{}],12:[function(e,t,n){n.endianness=function(){return"LE"},n.hostname=function(){return"undefined"!=typeof location?location.hostname:""},n.loadavg=function(){return[]},n.uptime=function(){return 0},n.freemem=function(){return Number.MAX_VALUE},n.totalmem=function(){return Number.MAX_VALUE},n.cpus=function(){return[]},n.type=function(){return"Browser"},n.release=function(){return"undefined"!=typeof navigator?navigator.appVersion:""},n.networkInterfaces=n.getNetworkInterfaces=function(){return{}},n.arch=function(){return"javascript"},n.platform=function(){return"browser"},n.tmpdir=n.tmpDir=function(){return"/tmp"},n.EOL="\n",n.homedir=function(){return"/"}},{}],13:[function(e,t,n){var o,r,i=t.exports={};function s(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function u(e){if(o===setTimeout)return setTimeout(e,0);if((o===s||!o)&&setTimeout)return o=setTimeout,setTimeout(e,0);try{return o(e,0)}catch(t){try{return o.call(null,e,0)}catch(t){return o.call(this,e,0)}}}!function(){try{o="function"==typeof setTimeout?setTimeout:s}catch(e){o=s}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(e){r=a}}();var c,l=[],d=!1,h=-1;function f(){d&&c&&(d=!1,c.length?l=c.concat(l):h=-1,l.length&&p())}function p(){if(!d){var e=u(f);d=!0;for(var t=l.length;t;){for(c=l,l=[];++h<t;)c&&c[h].run();h=-1,t=l.length}c=null,d=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function v(e,t){this.fun=e,this.array=t}function m(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];l.push(new v(e,t)),1!==l.length||d||u(p)},v.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=m,i.addListener=m,i.once=m,i.off=m,i.removeListener=m,i.removeAllListeners=m,i.emit=m,i.prependListener=m,i.prependOnceListener=m,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},{}],14:[function(e,t,n){var o;if("object"==typeof globalThis)o=globalThis;else try{o=e("es5-ext/global")}catch(e){}finally{if(o||"undefined"==typeof window||(o=window),!o)throw new Error("Could not determine global this")}var r=o.WebSocket||o.MozWebSocket,i=e("./version");function s(e,t){return t?new r(e,t):new r(e)}r&&["CONNECTING","OPEN","CLOSING","CLOSED"].forEach((function(e){Object.defineProperty(s,e,{get:function(){return r[e]}})})),t.exports={w3cwebsocket:r?s:null,version:i}},{"./version":15,"es5-ext/global":9}],15:[function(e,t,n){t.exports=e("../package.json").version},{"../package.json":16}],16:[function(e,t,n){t.exports={name:"websocket",description:"Websocket Client & Server Library implementing the WebSocket protocol as specified in RFC 6455.",keywords:["websocket","websockets","socket","networking","comet","push","RFC-6455","realtime","server","client"],author:"Brian McKelvey <theturtle32@gmail.com> (https://github.com/theturtle32)",contributors:["IÃ±aki Baz Castillo <ibc@aliax.net> (http://dev.sipdoc.net)"],version:"1.0.34",repository:{type:"git",url:"https://github.com/theturtle32/WebSocket-Node.git"},homepage:"https://github.com/theturtle32/WebSocket-Node",engines:{node:">=4.0.0"},dependencies:{bufferutil:"^4.0.1",debug:"^2.2.0","es5-ext":"^0.10.50","typedarray-to-buffer":"^3.1.5","utf-8-validate":"^5.0.2",yaeti:"^0.0.6"},devDependencies:{"buffer-equal":"^1.0.0",gulp:"^4.0.2","gulp-jshint":"^2.0.4","jshint-stylish":"^2.2.1",jshint:"^2.0.0",tape:"^4.9.1"},config:{verbose:!1},scripts:{test:"tape test/unit/*.js",gulp:"gulp"},main:"index",directories:{lib:"./lib"},browser:"lib/browser.js",license:"Apache-2.0"}},{}],17:[function(e,t,n){"use strict";var o=this&&this.__assign||function(){return o=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},o.apply(this,arguments)},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});var i=r(e("crypto-js/sha256")),s=r(e("crypto-js/enc-base64")),a=r(e("crypto-js/lib-typedarrays")),u=function(){function e(e){this.state="",this.codeVerifier="",this.config=e}return e.prototype.authorizeUrl=function(e){var t,n;void 0===e&&(e={});var r=new URLSearchParams(Object.assign(o({response_type:(null===(t=this.config)||void 0===t?void 0:t.implicit)?"token":"code",client_id:this.config.client_id,state:this.getState(e.state||null),scope:this.config.requested_scopes,redirect_uri:this.config.redirect_uri},(null===(n=this.config)||void 0===n?void 0:n.implicit)?{}:{code_challenge:this.pkceChallengeFromVerifier(),code_challenge_method:"S256"}),e)).toString();return"".concat(this.config.authorization_endpoint,"?").concat(r)},e.prototype.exchangeForAccessToken=function(e,t){var n=this;return void 0===t&&(t={}),this.parseAuthResponseUrl(e).then((function(r){var i,s;if(null===(i=n.config)||void 0===i?void 0:i.implicit){var a={access_token:"",expires_in:0,refresh_expires_in:0,refresh_token:"",scope:"",token_type:""};return new URL(e).searchParams.forEach((function(e,t){Object.keys(a).indexOf(t)>-1&&(a[t]="number"==typeof a[t]?Number(e):String(e))})),Promise.resolve(Object.assign(a,t))}return fetch(n.config.token_endpoint,{method:"POST",body:new URLSearchParams(Object.assign(o({grant_type:"authorization_code",code:r.code,client_id:n.config.client_id,redirect_uri:n.config.redirect_uri},(null===(s=n.config)||void 0===s?void 0:s.implicit)?{}:{code_verifier:n.getCodeVerifier()}),t)),headers:{Accept:"application/json","Content-Type":"application/x-www-form-urlencoded;charset=UTF-8"}}).then((function(e){return e.json()}))}))},e.prototype.getCodeVerifier=function(){return""===this.codeVerifier&&(this.codeVerifier=this.randomStringFromStorage("pkce_code_verifier")),this.codeVerifier},e.prototype.getState=function(e){void 0===e&&(e=null);var t="pkce_state";return null!==e&&this.getStore().setItem(t,e),""===this.state&&(this.state=this.randomStringFromStorage(t)),this.state},e.prototype.parseAuthResponseUrl=function(e){var t=new URL(e).searchParams;return this.validateAuthResponse({error:t.get("error"),query:t.get("query"),state:t.get("state"),code:t.get("code")})},e.prototype.pkceChallengeFromVerifier=function(){var e=(0,i.default)(this.getCodeVerifier());return s.default.stringify(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")},e.prototype.randomStringFromStorage=function(e){return null===this.getStore().getItem(e)&&this.getStore().setItem(e,a.default.random(64)),this.getStore().getItem(e)||""},e.prototype.validateAuthResponse=function(e){var t=this;return new Promise((function(n,o){var r;return e.error?o({error:e.error}):e.state===t.getState()||(null===(r=t.config)||void 0===r?void 0:r.implicit)?n(e):o({error:"Invalid State"})}))},e.prototype.getStore=function(){var e;return(null===(e=this.config)||void 0===e?void 0:e.storage)||sessionStorage},e}();n.default=u},{"crypto-js/enc-base64":4,"crypto-js/lib-typedarrays":5,"crypto-js/sha256":6}],18:[function(e,t,n){"use strict";var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function s(e){try{u(o.next(e))}catch(e){i(e)}}function a(e){try{u(o.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.XummPkce=n.XummPkceThread=void 0;const i=e("events"),s=e("xumm-sdk"),a=r(e("xumm-js-pkce")),u=function(...e){"undefined"!=typeof localStorage&&(null===localStorage||void 0===localStorage?void 0:localStorage.debug)&&console.log(...e)};"undefined"!=typeof window&&u("Xumm OAuth2 PKCE Authorization Code Flow lib.");const c=e=>{let t=e=>{};return{promise:new Promise((e=>{t=e})),resolve:e=>t(e)}};class l extends i.EventEmitter{constructor(e,t){var n,r;super(),this.popup=null,this.resolved=!1,this.mobileRedirectFlow=!1,this.eventPromises={retrieved:c(),error:c(),success:c(),loggedout:c()},this.options={redirectUrl:document.location.href,rememberJwt:!0,storage:localStorage,implicit:!1},"string"==typeof t?this.options.redirectUrl=t:"object"==typeof t&&t&&("string"==typeof t.redirectUrl&&(this.options.redirectUrl=t.redirectUrl),"boolean"==typeof t.rememberJwt&&(this.options.rememberJwt=t.rememberJwt),"object"==typeof t.storage&&(this.options.storage=t.storage),"boolean"==typeof t.implicit&&(this.options.implicit=t.implicit));const i={client_id:e,redirect_uri:this.options.redirectUrl,authorization_endpoint:"https://oauth2.xumm.app/auth",token_endpoint:"https://oauth2.xumm.app/token",requested_scopes:"XummPkce",storage:this.options.storage,implicit:this.options.implicit};if(this.pkce=new a.default(i),this.options.rememberJwt){u("Remember JWT");try{const e=JSON.parse((null===(n=this.options.storage)||void 0===n?void 0:n.getItem("XummPkceJwt"))||"{}");if((null==e?void 0:e.jwt)&&"string"==typeof e.jwt){const t=new s.XummSdkJwt(e.jwt);t.ping().then((n=>o(this,void 0,void 0,(function*(){var o;(null===(o=null==n?void 0:n.jwtData)||void 0===o?void 0:o.sub)?(this.autoResolvedFlow=Object.assign(e,{sdk:t}),yield this.authorize(),this.emit("retrieved")):this.logout()})))).catch((e=>{this.logout()}))}else this.logout()}catch(e){}}window.addEventListener("message",(e=>{var t;if(u("Received Event from ",e.origin),"{"===String((null==e?void 0:e.data)||"").slice(0,1)&&"}"===String((null==e?void 0:e.data)||"").slice(-1)&&(u("Got PostMessage with JSON"),"https://xumm.app"===e.origin||"https://oauth2.xumm.app"===e.origin)){u("Got PostMessage from https://xumm.app / https://oauth2.xumm.app");try{const n=JSON.parse(e.data);"xumm_sign_request"===(null==n?void 0:n.source)&&(null==n?void 0:n.payload)?u("Payload opened:",n.payload):"xumm_sign_request_resolved"===(null==n?void 0:n.source)&&(null==n?void 0:n.options)?(u("Payload resolved, mostmessage containing options containing redirect URL: ",n),this.resolved=!0,this.pkce.exchangeForAccessToken(n.options.full_redirect_uri).then((e=>{if(this.jwt=e.access_token,null==e?void 0:e.error_description)throw new Error(null==e?void 0:e.error_description);fetch("https://oauth2.xumm.app/userinfo",{headers:{Authorization:"Bearer "+e.access_token}}).then((e=>e.json())).then((t=>{var n;if(this.resolvePromise){if(this.options.rememberJwt){u("Remembering JWT");try{null===(n=this.options.storage)||void 0===n||n.setItem("XummPkceJwt",JSON.stringify({jwt:e.access_token,me:t}))}catch(e){u("Could not persist JWT to local storage",e)}}this.resolvePromise({jwt:e.access_token,sdk:new s.XummSdkJwt(e.access_token),me:t})}}))})).catch((e=>{this.rejectPromise&&this.rejectPromise((null==e?void 0:e.error)?new Error(e.error):e),u((null==e?void 0:e.error)||e)}))):"xumm_sign_request_rejected"===(null==n?void 0:n.source)?(u("Payload rejected",null==n?void 0:n.options),this.rejectPromise&&this.rejectPromise(new Error((null===(t=null==n?void 0:n.options)||void 0===t?void 0:t.error_description)||"Payload rejected"))):"xumm_sign_request_popup_closed"===(null==n?void 0:n.source)?(u("Popup closed, wait 750ms"),setTimeout((()=>{!this.resolved&&this.rejectPromise&&this.rejectPromise(new Error("Sign In window closed"))}),750)):u("Unexpected message, skipping",null==n?void 0:n.source)}catch(e){u("Error parsing message",(null==e?void 0:e.message)||e)}}}),!1);const l=new URLSearchParams((null===(r=null===document||void 0===document?void 0:document.location)||void 0===r?void 0:r.search)||"");if(l.get("authorization_code")||l.get("access_token")||l.get("error_description")){this.mobileRedirectFlow=!0,this.urlParams=l;let e=!1;const t=t=>o(this,void 0,void 0,(function*(){u("onDocumentReady",document.readyState),e||"complete"!==document.readyState||(e=!0,u("(readystatechange: [ "+document.readyState+" ])"),this.handleMobileGrant(),yield this.authorize(),this.emit("retrieved"))}));t(),document.addEventListener("readystatechange",t)}}emit(e,...t){return this.eventPromises[e].promise.then((()=>super.emit(e,...t))),!0}on(e,t){return this.eventPromises[e].resolve(),super.on(e,t)}off(e,t){return this.eventPromises[e]=c(),super.off(e,t)}authorizeUrl(){return this.pkce.authorizeUrl()}handleMobileGrant(){if(this.urlParams&&this.mobileRedirectFlow){const e={data:JSON.stringify(this.urlParams.get("authorization_code")||this.urlParams.get("access_token")?{source:"xumm_sign_request_resolved",options:{full_redirect_uri:document.location.href}}:{source:"xumm_sign_request_rejected",options:{error:this.urlParams.get("error"),error_code:this.urlParams.get("error_code"),error_description:this.urlParams.get("error_description")}}),origin:"https://oauth2.xumm.app"},t=new MessageEvent("message",e);return window.dispatchEvent(t),!0}return!1}authorize(){return o(this,void 0,void 0,(function*(){if(this.resolvedSuccessfully)return this.promise;if(this.resolved=!1,!this.mobileRedirectFlow&&!this.autoResolvedFlow){const e=this.authorizeUrl(),t=window.open(e,"XummPkceLogin","directories=no,titlebar=no,toolbar=no,location=no,status=no,menubar=no,scrollbars=no,resizable=no,width=600,height=790");this.popup=t,u("Popup opened...",e)}this.resolved=!1;return(()=>{var e;const t=new URLSearchParams((null===(e=null===document||void 0===document?void 0:document.location)||void 0===e?void 0:e.search)||"");t.delete("authorization_code"),t.delete("code"),t.delete("scope"),t.delete("state"),t.delete("access_token"),t.delete("refresh_token"),t.delete("token_type"),t.delete("expires_in");const n=t.toString(),o=document.location.href.split("?")[0]+(""!==n?"?":"")+n;window.history.replaceState({path:o},"",o)})(),this.autoResolvedFlow?this.resolved||(this.resolved=!0,this.promise=Promise.resolve(this.autoResolvedFlow),this.rejectPromise=this.resolvePromise=()=>{},u("Auto resolved"),this.emit("success")):this.promise=new Promise(((e,t)=>{this.resolvePromise=t=>{const n=e(t);return this.resolved=!0,this.resolvedSuccessfully=!0,u("Xumm Sign in RESOLVED"),this.emit("success"),n},this.rejectPromise=e=>{const n=t(e);return this.resolved=!0,this.emit("error","string"==typeof e?new Error(e):e),u("Xumm Sign in REJECTED"),n}})),this.promise}))}state(){return o(this,void 0,void 0,(function*(){return this.promise}))}logout(){var e;setTimeout((()=>this.emit("loggedout")),0);try{this.resolved=!1,this.resolvedSuccessfully=void 0,this.autoResolvedFlow=void 0,null===(e=this.options.storage)||void 0===e||e.removeItem("XummPkceJwt"),this.mobileRedirectFlow=!1}catch(e){}}getPopup(){return null==this?void 0:this.popup}}n.XummPkceThread=l;const d=e=>{let t=!1;e&&"object"==typeof window&&void 0===window._XummPkce&&(window._XummPkce=e,t=!0);const n=null===window||void 0===window?void 0:window._XummPkce;return n&&t&&u("XummPkce attached to window"),n};n.XummPkce=class{constructor(e,t){"undefined"!=typeof window&&"undefined"!=typeof document&&(d()||d(new l(e,t)))}on(e,t){const n=d();if(n)return n.on(e,t),this}off(e,t){const n=d();if(n)return n.off(e,t),this}authorize(){const e=d();if(e)return e.authorize()}state(){const e=d();if(e)return e.state()}logout(){const e=d();if(e)return e.logout()}}},{events:2,"xumm-js-pkce":17,"xumm-sdk":24}],19:[function(e,t,n){"use strict";var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function s(e){try{u(o.next(e))}catch(e){i(e)}}function a(e){try{u(o.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((o=o.apply(e,t||[])).next())}))};Object.defineProperty(n,"__esModule",{value:!0}),n.JwtUserdata=void 0;const r=e("debug"),i=e("./utils"),s=r.debug("xumm-sdk:xapp:userdata");n.JwtUserdata=class{constructor(e){s("Constructed"),this.Meta=e}list(){return o(this,void 0,void 0,(function*(){const e=yield this.Meta.call("userdata","GET");return i.throwIfError(e),e.keys}))}get(e){var t;return o(this,void 0,void 0,(function*(){const n=Array.isArray(e)?e.join(","):e,o=yield this.Meta.call("userdata/"+n,"GET");return i.throwIfError(o),n.split(",").length>1?o.data:(null===(t=o.data)||void 0===t?void 0:t[n])||{}}))}delete(e){return o(this,void 0,void 0,(function*(){const t=yield this.Meta.call("userdata/"+e,"DELETE");return i.throwIfError(t),t.persisted}))}set(e,t){return o(this,void 0,void 0,(function*(){const n=yield this.Meta.call("userdata/"+e,"POST",t);return i.throwIfError(n),n.persisted}))}}},{"./utils":25,debug:7}],20:[function(e,t,n){"use strict";var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function s(e){try{u(o.next(e))}catch(e){i(e)}}function a(e){try{u(o.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.Meta=void 0;const i=e("debug"),s=r(e("fetch-ponyfill")),{fetch:a,Request:u,Response:c,Headers:l}=s.default(),d=e("os-browserify"),h=e("./utils"),f=e("./index"),p=i.debug("xumm-sdk:meta");n.Meta=class{constructor(e,t){this.isBrowser=!1,this.jwtFlow=!1,this.injected=!1,this.endpoint="https://xumm.app",p("Constructed");const n=new RegExp("^[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}$"),o={split:t.split(":"),uuidv4:""};if(3===o.split.length&&"xApp:OneTimeToken"===o.split.slice(0,2).join(":")?(o.uuidv4=o.split[2],this.jwtFlow=!0):o.split.length>1&&"RAWJWT"===o.split[0]?(this.jwtFlow=!0,this.jwt=o.split.slice(1).join(":")):o.uuidv4=t,!n.test(e)||!n.test(o.uuidv4)){if(!this.jwtFlow)throw new Error("Invalid API Key and/or API Secret. Use dotenv or constructor params.");if(!this.jwt)throw new Error("Invalid API Key and/or OTT (One Time Token). Provide OTT param (2nd param) or make sure `xAppToken` query param is present (Browser)")}return"undefined"!=typeof globalThis&&Object.keys(globalThis).indexOf("window")<0?p("Running in node"):(console.log("XUMM SDK: Running in browser"),this.isBrowser=!0),this.apiKey=e,this.apiSecret=o.uuidv4,this.jwtFlow&&!this.jwt&&(this.authPromise=new Promise((e=>{this.authPromiseResolve=e})),Promise.resolve().then((()=>this.authorize())).catch((e=>{p("Authorize error:",e.message),(null==this?void 0:this.invoker)&&this.invoker.caught(e),this.authPromiseResolve&&this.authPromiseResolve()}))),this}setEndpoint(e){return!!e.match(/^http/)&&(this.endpoint=e.trim(),!0)}authorize(){var e,t,n,r;return o(this,void 0,void 0,(function*(){let o;p("JWT Authorize",this.apiSecret),(null==this?void 0:this.invoker)&&this.invoker.constructor===f.XummSdkJwt&&(o=this.invoker._jwtStore(this,(e=>this.jwt=e)));const i=(null==o?void 0:o.get(this.apiSecret))||(yield this.call("authorize"));if(null===(t=null===(e=i)||void 0===e?void 0:e.error)||void 0===t?void 0:t.code)p("Could not resolve API Key & OTT to JWT (already fetched? Unauthorized?)"),(null==this?void 0:this.invoker)&&this.invoker.constructor===f.XummSdkJwt&&(null===(n=null==this?void 0:this.invoker)||void 0===n?void 0:n.fatalHandler)?this.invoker.fatalHandler(new Error(i.error.reference)):h.throwIfError(i);else{if(!(null===(r=i)||void 0===r?void 0:r.jwt))throw new Error("Unexpected response for xApp JWT authorize request");{const e=i;null==o||o.set(this.apiSecret,e)}}this.authPromiseResolve&&this.authPromiseResolve()}))}call(e,t="GET",n){var r;return o(this,void 0,void 0,(function*(){const o=t.toUpperCase(),i=e.split("/")[0];this.jwtFlow&&!(null==this?void 0:this.jwt)&&this.authPromise&&"authorize"!==e&&(yield this.authPromise);try{let t;void 0!==n&&("object"==typeof n&&null!==n&&(t=JSON.stringify(n)),"string"==typeof n&&(t=n));const r={"Content-Type":"application/json"};this.isBrowser||Object.assign(r,{"User-Agent":`xumm-sdk/node (${d.hostname()}) node-fetch`}),this.jwtFlow?"authorize"===e?Object.assign(r,{"x-api-key":this.apiKey,"x-api-ott":this.apiSecret}):Object.assign(r,{Authorization:"Bearer "+this.jwt}):Object.assign(r,{"x-api-key":this.apiKey,"x-api-secret":this.apiSecret});const s=["authorize","ping","curated-assets","rates","payload","userdata","nftoken-detail"],u=this.jwtFlow&&s.indexOf(i)>-1?"jwt":"platform",c=yield a(this.endpoint+"/api/v1/"+u+"/"+e,{method:o,body:t,headers:r});return yield c.json()}catch(e){const t=new Error(`Unexpected response from XUMM API [${o}:${i}]`);throw t.stack=(null===(r=e)||void 0===r?void 0:r.stack)||void 0,t}}))}ping(){var e,t;return o(this,void 0,void 0,(function*(){const n=yield this.call("ping");if(h.throwIfError(n),void 0!==n.auth)return n.auth;if(void 0!==(null===(e=n)||void 0===e?void 0:e.ott_uuidv4))return{application:{uuidv4:n.app_uuidv4,name:n.app_name},jwtData:n};if(void 0!==(null===(t=n)||void 0===t?void 0:t.usertoken_uuidv4))return{application:{uuidv4:n.client_id,name:n.app_name},jwtData:n};throw new Error("Unexpected response for ping request")}))}getCuratedAssets(){return o(this,void 0,void 0,(function*(){return yield this.call("curated-assets")}))}getRates(e){return o(this,void 0,void 0,(function*(){return yield this.call("rates/"+e.trim().toUpperCase())}))}getKycStatus(e){return o(this,void 0,void 0,(function*(){if(e.trim().match(/^r/)){const t=yield this.call("kyc-status/"+e.trim());return(null==t?void 0:t.kycApproved)?"SUCCESSFUL":"NONE"}{const t=yield this.call("kyc-status","POST",{user_token:e});return(null==t?void 0:t.kycStatus)||"NONE"}}))}getTransaction(e){return o(this,void 0,void 0,(function*(){return yield this.call("xrpl-tx/"+e.trim())}))}getNftokenDetail(e){return o(this,void 0,void 0,(function*(){if(!this.jwtFlow)throw new Error("getNftokenDetail: only available in JWT (XummSdkJwt) mode");return yield this.call("nftoken-detail/"+e.trim())}))}verifyUserTokens(e){return o(this,void 0,void 0,(function*(){return(yield this.call("user-tokens","POST",{tokens:Array.isArray(e)?e:[e]})).tokens}))}_inject(e){if(this.injected)throw new Error("Cannot `_inject` twice");this.invoker=e}}},{"./index":24,"./utils":25,debug:7,"fetch-ponyfill":10,"os-browserify":12}],21:[function(e,t,n){"use strict";var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function s(e){try{u(o.next(e))}catch(e){i(e)}}function a(e){try{u(o.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((o=o.apply(e,t||[])).next())}))};Object.defineProperty(n,"__esModule",{value:!0}),n.Payload=void 0;const r=e("debug"),i=e("websocket"),s=e("./utils"),a=r.debug("xumm-sdk:payload"),u=r.debug("xumm-sdk:payload:websocket");n.Payload=class{constructor(e){a("Constructed"),this.Meta=e}resolvePayload(e){var t,n,r;return o(this,void 0,void 0,(function*(){if("string"==typeof e)return yield this.get(e,!0);if(void 0!==(null===(t=e)||void 0===t?void 0:t.uuid))return yield this.get(e.uuid,!0);if(void 0!==(null===(r=null===(n=e)||void 0===n?void 0:n.meta)||void 0===r?void 0:r.uuid))return e;throw new Error("Could not resolve payload (not found)")}))}create(e,t=!1){var n;return o(this,void 0,void 0,(function*(){const o=void 0!==e.TransactionType&&void 0===e.txjson,r=yield this.Meta.call("payload","POST",o?{txjson:e}:e);t&&s.throwIfError(r);return void 0!==(null===(n=r)||void 0===n?void 0:n.next)?r:null}))}get(e,t=!1){var n,r;return o(this,void 0,void 0,(function*(){const o="string"==typeof e?e:null==e?void 0:e.uuid,i=yield this.Meta.call("payload/"+o,"GET");t&&s.throwIfError(i);return void 0!==(null===(r=null===(n=i)||void 0===n?void 0:n.meta)||void 0===r?void 0:r.uuid)?i:null}))}subscribe(e,t){var n,r;return o(this,void 0,void 0,(function*(){const a=new s.DeferredPromise,c=yield this.resolvePayload(e);if(c){const e="undefined",s=typeof(null===(n=globalThis)||void 0===n?void 0:n.MockedWebSocket)!==e&&typeof jest!==e?new(null===(r=globalThis)||void 0===r?void 0:r.MockedWebSocket)("ws://xumm.local"):new i.w3cwebsocket(this.Meta.endpoint.replace(/^http/,"ws")+"/sign/"+c.meta.uuid);return a.promise.then((()=>{s.close()})),s.onopen=()=>{u(`Payload ${c.meta.uuid}: Subscription active (WebSocket opened)`)},s.onmessage=e=>o(this,void 0,void 0,(function*(){const n=e.data;let r;try{r=JSON.parse(n.toString())}catch(e){u(`Payload ${c.meta.uuid}: Received message, unable to parse as JSON`,e)}if(r&&t&&void 0===r.devapp_fetched)try{const e=yield t({uuid:c.meta.uuid,data:r,resolve(e){return o(this,void 0,void 0,(function*(){yield a.resolve(e||void 0)}))},payload:c});void 0!==e&&a.resolve(e)}catch(e){u(`Payload ${c.meta.uuid}: Callback exception`,e)}})),s.onclose=e=>{u(`Payload ${c.meta.uuid}: Subscription ended (WebSocket closed)`)},{payload:c,resolve(e){a.resolve(e||void 0)},resolved:a.promise,websocket:s}}throw s.throwIfError(c),Error("Couldn't subscribe: couldn't fetch payload")}))}cancel(e,t=!1){var n,r,i;return o(this,void 0,void 0,(function*(){const o=yield this.resolvePayload(e),a=yield this.Meta.call("payload/"+(null===(n=null==o?void 0:o.meta)||void 0===n?void 0:n.uuid),"DELETE");t&&s.throwIfError(a);return void 0!==(null===(i=null===(r=a)||void 0===r?void 0:r.meta)||void 0===i?void 0:i.uuid)?a:null}))}createAndSubscribe(e,t){return o(this,void 0,void 0,(function*(){const n=yield this.create(e,!0);if(n){const e=yield this.subscribe(n,t);return Object.assign({created:n},e)}throw new Error("Error creating payload or subscribing to created payload")}))}}},{"./utils":25,debug:7,websocket:14}],22:[function(e,t,n){"use strict";var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function s(e){try{u(o.next(e))}catch(e){i(e)}}function a(e){try{u(o.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((o=o.apply(e,t||[])).next())}))};Object.defineProperty(n,"__esModule",{value:!0}),n.Push=void 0;const r=e("debug"),i=e("./JwtUserdata"),s=e("./utils"),a=r.debug("xumm-sdk:xapp");n.Push=class{constructor(e){a("Constructed"),this.Meta=e,this.userdata=new i.JwtUserdata(e)}event(e){return o(this,void 0,void 0,(function*(){const t=yield this.Meta.call("xapp/event","POST",e);return s.throwIfError(t),t}))}notification(e){return o(this,void 0,void 0,(function*(){const t=yield this.Meta.call("xapp/push","POST",e);return s.throwIfError(t),t}))}}},{"./JwtUserdata":19,"./utils":25,debug:7}],23:[function(e,t,n){"use strict";var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function s(e){try{u(o.next(e))}catch(e){i(e)}}function a(e){try{u(o.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((o=o.apply(e,t||[])).next())}))};Object.defineProperty(n,"__esModule",{value:!0}),n.Storage=void 0;const r=e("debug"),i=e("./utils"),s=r.debug("xumm-sdk:storage");n.Storage=class{constructor(e){s("Constructed"),this.Meta=e}get(){return o(this,void 0,void 0,(function*(){const e=yield this.Meta.call("app-storage","GET");return i.throwIfError(e),e.data}))}set(e){return o(this,void 0,void 0,(function*(){const t=yield this.Meta.call("app-storage","POST",e);return i.throwIfError(t),t.stored}))}delete(){return o(this,void 0,void 0,(function*(){const e=yield this.Meta.call("app-storage","DELETE");return i.throwIfError(e),e.stored}))}}},{"./utils":25,debug:7}],24:[function(e,t,n){(function(t){(function(){"use strict";var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function s(e){try{u(o.next(e))}catch(e){i(e)}}function a(e){try{u(o.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((o=o.apply(e,t||[])).next())}))};Object.defineProperty(n,"__esModule",{value:!0}),n.XummSdkJwt=n.XummSdk=void 0;const r=e("debug"),i=e("./Meta"),s=e("./Storage"),a=e("./Payload"),u=e("./xApp"),c=e("./Push"),l=e("./JwtUserdata"),d=r.debug("xumm-sdk");class h{constructor(e,t){return d("Constructed"),this.Meta=new i.Meta(e||this.getEnv("XUMM_APIKEY"),t||this.getEnv("XUMM_APISECRET")),this.storage=new s.Storage(this.Meta),this.payload=new a.Payload(this.Meta),this.jwtUserdata=new l.JwtUserdata(this.Meta),this.Push=new c.Push(this.Meta),this.xApp=new u.xApp(this.Meta),this.Meta._inject(this),this}getEnv(e){let n="";try{n="undefined"!=typeof Deno&&Deno.env.get(e)||"",n=(null==t?void 0:t.env[e])||""}catch(e){}return n}ping(){return this.Meta.ping()}getCuratedAssets(){return this.Meta.getCuratedAssets()}getRates(e){return this.Meta.getRates(e)}getKycStatus(e){return this.Meta.getKycStatus(e)}getTransaction(e){return this.Meta.getTransaction(e)}getNftokenDetail(e){return this.Meta.getNftokenDetail(e)}verifyUserTokens(e){return this.Meta.verifyUserTokens(e)}verifyUserToken(e){return o(this,void 0,void 0,(function*(){const t=yield this.Meta.verifyUserTokens([e]);return Array.isArray(t)&&1===t.length?t[0]:null}))}setEndpoint(e){return this.Meta.setEndpoint(e)}caught(e){throw e}}n.XummSdk=h;n.XummSdkJwt=class extends h{constructor(e,t,n){var o,r,i,s,a,u,c,l;let h=String(t||"").trim().toLowerCase();const f=36!==e.length;if(!f&&void 0===t&&"undefined"!=typeof window&&void 0!==window.URLSearchParams){const e=new window.URLSearchParams((null===(o=null===window||void 0===window?void 0:window.location)||void 0===o?void 0:o.search)||"");for(const t of e.entries())"xAppToken"===t[0]&&(h=t[1].toLowerCase().trim());if(""===h&&!(null==n?void 0:n.store)&&!(null==n?void 0:n.noAutoRetrieve)&&"string"==typeof(null===(r=null===window||void 0===window?void 0:window.localStorage)||void 0===r?void 0:r.XummSdkJwt))try{const e=null===(s=null===(i=null===window||void 0===window?void 0:window.localStorage)||void 0===i?void 0:i.XummSdkJwt)||void 0===s?void 0:s.split(":"),t=JSON.parse(null===(a=null==e?void 0:e.slice(1))||void 0===a?void 0:a.join(":"));if(null==t?void 0:t.jwt){const n=JSON.parse(atob(null===(u=t.jwt.split("."))||void 0===u?void 0:u[1]));if(null==n?void 0:n.exp){const t=(null==n?void 0:n.exp)-Math.floor((new Date).getTime()/1e3);console.log("Restoring OTT "+(null==e?void 0:e[0])),t>3600?h=null==e?void 0:e[0]:console.log("Skip restore: not valid for one more hour")}}}catch(e){console.log("JWT Restore Error",e)}}super(e,f||""===h?"RAWJWT:"+e:"xApp:OneTimeToken:"+h),this.resolve=e=>{d("OTT data resolved",e)},this.reject=e=>{d("OTT data rejected",e.message)},this.ottResolved=f?Promise.resolve():new Promise(((e,t)=>{this.resolve=e,this.reject=t})),(null==n?void 0:n.fatalHandler)&&(this.fatalHandler=n.fatalHandler),this.store={get(e){var t;if(d("[JwtStore] Â» Builtin JWT store GET"),"undefined"!=typeof window&&void 0!==window.localStorage&&"string"==typeof window.localStorage.XummSdkJwt){const n=window.localStorage.XummSdkJwt.split(":");if(n[0]===e){d("Restoring OTT from localStorage:",e);try{return JSON.parse(n.slice(1).join(":"))}catch(e){d("Error restoring OTT Data (JWT) from localStorage",null===(t=e)||void 0===t?void 0:t.message)}}}},set(e,t){d("[JwtStore] Â» Builtin JWT store SET",e),"undefined"!=typeof window&&"undefined"!=typeof localStorage&&(window.localStorage.XummSdkJwt=e+":"+JSON.stringify(t))}},(null===(c=null==n?void 0:n.store)||void 0===c?void 0:c.get)&&(this.store.get=n.store.get),(null===(l=null==n?void 0:n.store)||void 0===l?void 0:l.set)&&(this.store.set=n.store.set),f?(this.reject(new Error("Not in OTT flow: in raw JWT (OAuth2-like) flow")),d("Using JWT (Raw, OAuth2) flow")):d("Using JWT (xApp) flow")}_jwtStore(e,t){if(e&&(null==e?void 0:e.constructor)===i.Meta)return{get:e=>{var t;return d("[JwtStore] Proxy GET"),null===(t=this.store)||void 0===t?void 0:t.get(e)},set:(e,n)=>{var o;return d("[JwtStore] Proxy SET"),this.resolve(n.ott),t(n.jwt),this.jwt=n.jwt,null===(o=this.store)||void 0===o?void 0:o.set(e,n)}};throw new Error("Invalid _jwtStore invoker")}getOttData(){return o(this,void 0,void 0,(function*(){const e=yield this.ottResolved;if(e)return e;throw new Error("Called getOttData on a non OTT-JWT flow")}))}getJwt(){return o(this,void 0,void 0,(function*(){return yield this.ottResolved,this.jwt}))}caught(e){this.reject(e)}}}).call(this)}).call(this,e("_process"))},{"./JwtUserdata":19,"./Meta":20,"./Payload":21,"./Push":22,"./Storage":23,"./xApp":26,_process:13,debug:7}],25:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.DeferredPromise=n.throwIfError=void 0,n.throwIfError=function(e){var t,n,o,r,i,s;if(void 0!==e.message)throw new Error(e.message);if(void 0===e.next&&void 0===(null===(n=null===(t=e)||void 0===t?void 0:t.meta)||void 0===n?void 0:n.uuid)&&void 0===(null===(r=null===(o=e)||void 0===o?void 0:o.application)||void 0===r?void 0:r.uuidv4)&&void 0!==(null===(s=null===(i=e)||void 0===i?void 0:i.error)||void 0===s?void 0:s.code)){const t=e.error;throw new Error(`Error code ${t.code}, see XUMM Dev Console, reference: ${t.reference}`)}};n.DeferredPromise=class{constructor(){this.resolveFn=e=>{},this.rejectFn=e=>{},this.promise=new Promise(((e,t)=>{this.resolveFn=e,this.rejectFn=t}))}resolve(e){return this.resolveFn(e),this.promise}reject(e){return this.rejectFn(e),this.promise}}},{}],26:[function(e,t,n){"use strict";var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function s(e){try{u(o.next(e))}catch(e){i(e)}}function a(e){try{u(o.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((o=o.apply(e,t||[])).next())}))};Object.defineProperty(n,"__esModule",{value:!0}),n.xApp=void 0;const r=e("debug"),i=e("./JwtUserdata"),s=e("./utils"),a=r.debug("xumm-sdk:xapp");n.xApp=class{constructor(e){a("Constructed"),this.Meta=e,this.userdata=new i.JwtUserdata(e)}get(e){return o(this,void 0,void 0,(function*(){const t=yield this.Meta.call("xapp/ott/"+e,"GET");return s.throwIfError(t),t}))}}},{"./JwtUserdata":19,"./utils":25,debug:7}],27:[function(e,t,n){"use strict";var o,r=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,r)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)},s=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function s(e){try{u(o.next(e))}catch(e){i(e)}}function a(e){try{u(o.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((o=o.apply(e,t||[])).next())}))};Object.defineProperty(n,"__esModule",{value:!0}),n.xApp=void 0;const a=e("events"),u=e("./types");i(e("./types"),n);const c=Number(new Date);let l;const d=new Promise((e=>{l=t=>{console.log("Doc Ready...");const n=(Number(new Date)-c)/1e3;n<1?(console.log("Doc not alive >= 1 sec, stalling for "+(1-n)),setTimeout((function(){e(t)}),1e3*(1-n))):(console.log("Doc alive 1+ sec, go ahead"),e(t))}}));d.then((()=>{console.log("documentReadyPromise resolved")})).catch((e=>{console.log(e)})),"undefined"!=typeof document&&document.addEventListener("readystatechange",(e=>{console.log("(readystatechange: [ "+document.readyState+" ])"),"complete"===document.readyState&&l()})),"undefined"!=typeof window&&console.log("Loading xApp SDK");let h="undefined"!=typeof window?window:{},f=!1;(null==h?void 0:h.parent)&&(null===(o=h.parent)||void 0===o||o.postMessage("XAPP_PROXY_INIT","*"));const p=(e,t,n=0)=>s(void 0,void 0,void 0,(function*(){var o,r;if(yield d,void 0!==(null==h?void 0:h.ReactNativeWebView)||f){const n=(Number(new Date)-c)/1e3;if(["close"].indexOf(e)>-1){const e=4;n<e&&(console.log("xApp close, doc alive < minAliveTimeSec, stall: "+(e-n)),yield new Promise((t=>{setTimeout((()=>{t(!0)}),1e3*(e-n))})))}const i=JSON.stringify(Object.assign({command:e},t||{}));return f?null===(o=h.parent)||void 0===o||o.postMessage(i,"*"):null===(r=h.ReactNativeWebView)||void 0===r||r.postMessage(i),console.log("xAppActionAttempt Success",e,t),!0}return 250*n<2e3?(console.log("xAppActionAttempt Attempt "+n+" Â» Retry",e,t),yield new Promise((e=>{setTimeout(e,250)})),p(e,t,n+1)):(console.log("xAppActionAttempt Failed after attempt "+n,e,t),new Error("xApp."+e.replace(/^xApp/,"")+": could not contact Xumm App Host"))}));class v extends a.EventEmitter{constructor(){super(),"complete"===document.readyState&&l();const e=e=>{const t=e;if("string"==typeof(null==t?void 0:t.data)&&"XAPP_PROXY_INIT_ACK"===t.data)return console.log("xApp Proxy ACK received, switching to PROXY (SANDBOX) mode"),void(f=!0);try{const e=JSON.parse((null==t?void 0:t.data)||"{}");if(console.log({_event:e}),"object"==typeof e&&null!==e)if("string"==typeof e.method&&e.method in u.xAppEvents){console.log("xApp Event received",e.method,e);const t=e.method;switch(delete e.method,t){case String(u.xAppEvents.payloadResolved):this.emit("payload",e);break;case String(u.xAppEvents.scanQr):this.emit("qr",e);break;case String(u.xAppEvents.selectDestination):this.emit("destination",e)}}else console.log("xApp Event received, not in xAppEvents",e.method,u.xAppEvents)}catch(e){const t=(null==e?void 0:e.message)||"";t.match(/XAPP_PROXY_INIT/)||console.log("xApp Event received, cannot parse as JSON",t)}};"function"==typeof window.addEventListener&&window.addEventListener("message",e),"function"==typeof document.addEventListener&&document.addEventListener("message",e)}navigate(e){return"string"!=typeof(null==e?void 0:e.xApp)?Promise.reject(new Error("xApp.navigate: Invalid argument: `xApp`")):p("xAppNavigate",e)}openSignRequest(e){return"string"!=typeof(null==e?void 0:e.uuid)?Promise.reject(new Error("xApp.openSignRequest: Invalid argument: `uuid`")):e.uuid.match(/^[0-9A-F]{8}-[0-9A-F]{4}-4[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i)?p("openSignRequest",e):Promise.reject(new Error("xApp.openSignRequest: Invalid payload UUID"))}selectDestination(){return p("selectDestination")}openBrowser(e){return"string"!=typeof(null==e?void 0:e.url)?Promise.reject(new Error("xApp.openBrowser: Invalid argument: `url`")):p("openBrowser",e)}share(e){return"string"!=typeof(null==e?void 0:e.text)?Promise.reject(new Error("xApp.share: Invalid argument: `text`")):p("share",e)}scanQr(){return p("scanQr")}tx(e){return"string"!=typeof(null==e?void 0:e.tx)?Promise.reject(new Error("xApp.tx: Invalid argument: `tx`")):"string"!=typeof(null==e?void 0:e.account)?Promise.reject(new Error("xApp.tx: Invalid argument: `account`")):p("txDetails",e)}close(e){return p("close",e)}customCommand(e,t){return p(e,t)}}const m=e=>{let t=!1;e&&"object"==typeof h&&void 0===h._xAppSdk&&(h._xAppSdk=e,t=!0);const n=null==h?void 0:h._xAppSdk;return n&&t&&console.log("xAppSdk attached to window"),n};n.xApp=class{constructor(){"undefined"!=typeof window&&"undefined"!=typeof document&&(m()||m(new v))}on(e,t){const n=m();if(n)return n.on(e,t),this}off(e,t){const n=m();if(n)return n.off(e,t),this}navigate(e){const t=m();if(t)return t.navigate(e)}openSignRequest(e){const t=m();if(t&&(null==e?void 0:e.uuid))return t.openSignRequest(e)}selectDestination(){const e=m();if(e)return e.selectDestination()}openBrowser(e){const t=m();if(t)return t.openBrowser(e)}share(e){const t=m();if(t)return t.share(e)}scanQr(){const e=m();if(e)return e.scanQr()}tx(e){const t=m();if(t)return t.tx(e)}close(e){const t=m();if(t)return t.close(e)}customCommand(e,t){const n=m();if(n)return n.customCommand(e,t)}}},{"./types":28,events:2}],28:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.xAppEvents=void 0,function(e){e.scanQr="scanQr",e.payloadResolved="payloadResolved",e.selectDestination="selectDestination"}(n.xAppEvents||(n.xAppEvents={}))},{}],Xumm:[function(e,t,n){(function(o){(function(){"use strict";var r=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function s(e){try{u(o.next(e))}catch(e){i(e)}}function a(e){try{u(o.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((o=o.apply(e,t||[])).next())}))};Object.defineProperty(n,"__esModule",{value:!0}),n.Xumm=void 0;const i=e("xumm-oauth2-pkce"),s=e("events");var a;!function(e){e.cli="cli",e.browser="browser",e.xapp="xapp"}(a||(a={}));const u={cli:!1,browser:!1,xapp:!1},c=new RegExp("^[0-9(a-f|A-F)]{8}-[0-9(a-f|A-F)]{4}-4[0-9(a-f|A-F)]{3}-[89ab][0-9(a-f|A-F)]{3}-[0-9(a-f|A-F)]{12}$"),l={},d="object"==typeof o&&o&&(null==o?void 0:o.env)||{};Object.assign(u,{cli:Object.keys(d).indexOf("NODE")>-1||Object.keys(d).indexOf("SHELL")>-1||Object.keys(d).indexOf("TERM")>-1||Object.keys(d).indexOf("PATH")>-1}),Object.assign(u,{browser:"object"==typeof o&&o&&(null==o?void 0:o.browser)||"object"==typeof document&&document&&(null===document||void 0===document?void 0:document.location)}),Object.assign(u,{xapp:u.browser&&!!navigator.userAgent.match(/xumm\/xapp/i)});const h=Object.keys(u).filter((e=>u[e])),f=[],p=e=>r(void 0,void 0,void 0,(function*(){return yield Promise.all(f),yield e()})),v=e=>new Proxy(e,{get:(e,t)=>["on","off"].indexOf(String(t))<0&&("function"==typeof e[t]||"Promise"===e.constructor.name)?function(){return"Promise"===e.constructor.name?e.then((e=>p((()=>e[t](...arguments))))):p((()=>e[t](...arguments)))}:e[t]}),m={XummSdk:!1,XummSdkJwt:!1,XummPkce:!1,xApp:!1};let y,w="",g={},b={},_=0;class x{constructor(){this.account=p((()=>{var e,t,n;return null!==(t=null!==(e=null==g?void 0:g.sub)&&void 0!==e?e:null==b?void 0:b.sub)&&void 0!==t?t:null===(n=null==y?void 0:y.account_info)||void 0===n?void 0:n.account})),this.picture=p((()=>{var e,t,n,o,r,i,s;return null!==(e=null==b?void 0:b.picture)&&void 0!==e?e:(null!==(n=null!==(t=null==g?void 0:g.sub)&&void 0!==t?t:null==b?void 0:b.sub)&&void 0!==n?n:null===(o=null==y?void 0:y.account_info)||void 0===o?void 0:o.account)?`https://xumm.app/avatar/${null!==(i=null!==(r=null==g?void 0:g.sub)&&void 0!==r?r:null==b?void 0:b.sub)&&void 0!==i?i:null===(s=null==y?void 0:y.account_info)||void 0===s?void 0:s.account}.png`:void 0})),this.name=p((()=>{var e,t;return null!==(e=null==b?void 0:b.name)&&void 0!==e?e:null===(t=null==y?void 0:y.account_info)||void 0===t?void 0:t.name})),this.domain=p((()=>{var e,t;return null!==(e=null==b?void 0:b.domain)&&void 0!==e?e:null===(t=null==y?void 0:y.account_info)||void 0===t?void 0:t.domain})),this.source=p((()=>{var e,t;return null!==(e=null==b?void 0:b.source)&&void 0!==e?e:null===(t=null==y?void 0:y.account_info)||void 0===t?void 0:t.source})),this.networkType=p((()=>{var e,t;return null!==(t=null!==(e=null==b?void 0:b.networkType)&&void 0!==e?e:g.network_type)&&void 0!==t?t:null==y?void 0:y.nodetype})),this.networkEndpoint=p((()=>{var e,t;return null!==(t=null!==(e=null==b?void 0:b.networkEndpoint)&&void 0!==e?e:g.network_ndpoint)&&void 0!==t?t:null==y?void 0:y.nodewss})),this.blocked=p((()=>{var e,t;return null!==(e=null==b?void 0:b.blocked)&&void 0!==e?e:null===(t=null==y?void 0:y.account_info)||void 0===t?void 0:t.blocked})),this.kycApproved=p((()=>{var e,t;return null!==(e=null==b?void 0:b.kycApproved)&&void 0!==e?e:null===(t=null==y?void 0:y.account_info)||void 0===t?void 0:t.kycApproved})),this.proSubscription=p((()=>{var e,t;return null!==(e=null==b?void 0:b.proSubscription)&&void 0!==e?e:null===(t=null==y?void 0:y.account_info)||void 0===t?void 0:t.proSubscription})),this.profile=p((()=>{var e,t,n;return null!==(e=null==b?void 0:b.profile)&&void 0!==e?e:(null===(n=null===(t=null==y?void 0:y.account_info)||void 0===t?void 0:t.profile)||void 0===n?void 0:n.slug)?y.account_info.profile:void 0})),this.token=p((()=>{var e;return null!==(e=null==g?void 0:g.usertoken_uuidv4)&&void 0!==e?e:null}))}}class k extends s.EventEmitter{constructor(e,t){var n,o,r,i;super(),this.instance="0",this.jwtCredential=!1,this.runtime=u,this.apiKeyOrJwt="",this.apiKeyOrJwt=e,this.apiSecretOrOtt=t,_++,this.instance=String(_),void 0!==(null===console||void 0===console?void 0:console.log)&&(u.cli||console.log("Constructed Xumm",{runtime:h}));let s=!1;if("string"==typeof this.apiKeyOrJwt&&3===this.apiKeyOrJwt.split(".").length){let e;try{e=JSON.parse(atob(null===(n=this.apiKeyOrJwt.split("."))||void 0===n?void 0:n[1]))}catch(e){}if(Date.now()>=1e3*e.exp){s=!0;const t=null!==(i=null!==(r=null!==(o=null==e?void 0:e.app_uuidv4)&&void 0!==o?o:null==e?void 0:e.client_id)&&void 0!==r?r:null==e?void 0:e.aud)&&void 0!==i?i:"";if(this.apiKeyOrJwt=t,u.cli||console.log("JWT expired, falling back to API KEY: "+t),u.cli||u.xapp){const e=new Error("JWT Expired, cannot fall back to API credential: in CLI/xApp environment");throw this.emit("error",e),e}}s||(this.jwtCredential=!0,w=this.apiKeyOrJwt)}this.initialize(),this.user=new x,this.environment={jwt:p((()=>g)),ott:p((()=>y)),openid:p((()=>b)),bearer:p((()=>w)),ready:new Promise((e=>this.on("ready",(()=>e(void 0))))),success:new Promise((e=>this.on("success",(()=>e(void 0))))),retrieved:new Promise((e=>this.on("retrieved",(()=>e(void 0))))),retrieving:new Promise((e=>this.on("retrieving",(()=>e(void 0)))))},this.helpers=v(p((()=>l.XummSdk||l.XummSdkJwt))),this.push=v(p((()=>(l.XummSdk||l.XummSdkJwt).Push))),this.payload=v(p((()=>(l.XummSdk||l.XummSdkJwt).payload))),this.userstore=v(p((()=>(l.XummSdk||l.XummSdkJwt).jwtUserdata))),this.backendstore=v(p((()=>(l.XummSdk||l.XummSdkJwt).storage)));const a=null==l?void 0:l.xApp;a&&(this.xapp=a),setTimeout((()=>Promise.all([...f.filter((e=>"pkceRetrieverResolver"!==(null==e?void 0:e.promiseType))),new Promise((e=>{var t;(null==l?void 0:l.XummPkce)?(this.user.account.then((()=>e())),null===(t=l.XummPkce)||void 0===t||t.on("loggedout",(()=>e()))):e()}))]).then((()=>this.emit("ready")))),0)}initialize(){y=void 0,w="",g={},b={},m.XummSdkJwt=!1;const t=()=>r(this,void 0,void 0,(function*(){(null==l?void 0:l.xApp)&&(m.xApp=!0,l.xApp.on("qr",(e=>{this.emit("qr",e,this.instance)})),l.xApp.on("payload",(e=>{this.emit("payload",e,this.instance)})),l.xApp.on("destination",(e=>{this.emit("destination",e,this.instance)})))}));this.handlePkceEvents();const n=()=>r(this,void 0,void 0,(function*(){var e;if((null==l?void 0:l.XummSdkJwt)&&!m.XummSdkJwt){m.XummSdkJwt=!0;const t=this.jwtCredential||""!==w;t||(f.push(l.XummSdkJwt.getOttData()),f.push(l.XummSdkJwt.getJwt()));const n=t?null:yield l.XummSdkJwt.getOttData(),o=t?w:yield l.XummSdkJwt.getJwt();if(n&&(y=n,this.emit("retrieved"),this.emit("success")),o){w=o;try{g=JSON.parse(atob(null===(e=w.split("."))||void 0===e?void 0:e[1]))}catch(e){void 0!==(null===console||void 0===console?void 0:console.log)&&(u.cli||console.log("Error decoding JWT",(null==e?void 0:e.message)||""))}}null===console||void 0===console||console.log}})),o=()=>{(null==l?void 0:l.XummSdkJwt)||(Object.assign(l,{XummSdkJwt:new(e("xumm-sdk").XummSdkJwt)(this.apiKeyOrJwt)}),f.push(n()))};if(u.xapp){if("string"!=typeof this.apiKeyOrJwt||!c.test(this.apiKeyOrJwt)&&!this.jwtCredential)throw new Error("Running in xApp, constructor requires first param. to be Xumm API Key or JWT");(null==l?void 0:l.xApp)||Object.assign(l,{xApp:new(e("xumm-xapp-sdk").xApp)}),f.push(t()),o()}else if(u.browser){if("string"!=typeof this.apiKeyOrJwt||!c.test(this.apiKeyOrJwt)&&!this.jwtCredential)throw new Error("Running in browser, constructor requires first param. to be Xumm API Key or JWT");if(!(null==l?void 0:l.XummPkce)&&(Object.assign(l,{XummPkce:new i.XummPkce(this.apiKeyOrJwt,{implicit:!0})}),l.XummPkce))if(this.jwtCredential)o();else{setTimeout((()=>this.emit("retrieving")),0);const e=e=>{var t,o;null===(o=null===(t=l.XummPkce)||void 0===t?void 0:t.state())||void 0===o||o.then((t=>{(null==t?void 0:t.sdk)&&!(null==l?void 0:l.XummSdkJwt)&&(Object.assign(l,{XummSdkJwt:t.sdk}),Object.assign(b,Object.assign({},(null==t?void 0:t.me)||{}))),(null==t?void 0:t.jwt)&&""===w&&(w=t.jwt,n()),e(t)}))};f.push(this.handlePkceEvents());const t=new Promise((t=>{var n,o;null===(n=l.XummPkce)||void 0===n||n.on("retrieved",(()=>{e(t)})),null===(o=l.XummPkce)||void 0===o||o.on("success",(()=>{e(t)}))}));f.push(Object.assign(t,{promiseType:"pkceRetrieverResolver"}))}}else if(u.cli){if("string"!=typeof this.apiKeyOrJwt)throw new Error("Running CLI, constructor needs first param. to be Xumm API Key / raw JWT");if(c.test(this.apiKeyOrJwt)&&("string"!=typeof this.apiSecretOrOtt||!c.test(this.apiSecretOrOtt)))throw new Error("Running CLI, constructor first param. is API Key, but second param. isn't a valid API Secret");if(!c.test(this.apiKeyOrJwt)&&3!==this.apiKeyOrJwt.split(".").length)throw new Error("Running CLI, constructor first param. not a valid JWT, nor a valid API Key");this.jwtCredential?o():(null==l?void 0:l.XummSdk)||Object.assign(l,{XummSdk:new(e("xumm-sdk").XummSdk)(this.apiKeyOrJwt,this.apiSecretOrOtt)})}}authorize(){var e;return r(this,void 0,void 0,(function*(){try{return yield null===(e=null==l?void 0:l.XummPkce)||void 0===e?void 0:e.authorize()}catch(e){return e}}))}handlePkceEvents(){return r(this,void 0,void 0,(function*(){if((null==l?void 0:l.XummPkce)&&!m.XummPkce){m.XummPkce=!0;const e=()=>this.emit("retrieved"),t=()=>this.emit("success"),n=e=>this.emit("error",e);l.XummPkce.on("retrieved",e),l.XummPkce.on("success",t),l.XummPkce.on("error",n)}}))}logout(){var e;return r(this,void 0,void 0,(function*(){u.browser&&(null==b?void 0:b.sub)&&(null===(e=null==l?void 0:l.XummPkce)||void 0===e||e.logout(),Object.assign(l,{XummSdkJwt:void 0,XummPkce:void 0}),f.length=0,this.jwtCredential=!1,this.initialize(),this.user=new x,this.environment={jwt:p((()=>g)),ott:p((()=>y)),openid:p((()=>b)),bearer:p((()=>w)),ready:new Promise((e=>this.on("ready",(()=>e(void 0))))),success:new Promise((e=>this.on("success",(()=>e(void 0))))),retrieved:new Promise((e=>this.on("retrieved",(()=>e(void 0))))),retrieving:new Promise((e=>this.on("retrieving",(()=>e(void 0)))))},this.emit("logout"))}))}ping(){var e;return r(this,void 0,void 0,(function*(){return yield Promise.all(f),null===(e=(null==l?void 0:l.XummSdkJwt)||(null==l?void 0:l.XummSdk))||void 0===e?void 0:e.ping()}))}}n.Xumm=k,t.exports=k}).call(this)}).call(this,e("_process"))},{_process:13,events:2,"xumm-oauth2-pkce":18,"xumm-sdk":24,"xumm-xapp-sdk":27}]},{},[])("Xumm")}));
